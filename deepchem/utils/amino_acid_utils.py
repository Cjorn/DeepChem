#!/usr/bin/env python2
# -*- coding: utf-8 -*-
"""
Created on Wed Jun  7 11:49:05 2017

@author: zqwu
"""
import numpy as np

AminoAcid = {
    '-': 21,
    'A': 0,
    'R': 1,
    'N': 2,
    'D': 3,
    'C': 4,
    'Q': 5,
    'E': 6,
    'G': 7,
    'H': 8,
    'I': 9,
    'L': 10,
    'K': 11,
    'M': 12,
    'F': 13,
    'P': 14,
    'S': 15,
    'T': 16,
    'W': 17,
    'Y': 18,
    'V': 19,
    'X': 20}

AminoAcid_SMILES = {
    'A': 'O=C(O)C(N)C',
    'R': 'NC(CCCNC(N)=N)C(O)=O',
    'N': 'O=C(N)C[C@H](N)C(=O)O',
    'D': 'O=C(O)CC(N)C(=O)O',
    'C': 'C([C@@H](C(=O)O)N)S',
    'Q': 'O=C(N)CCC(N)C(=O)O',
    'E': 'C(CC(=O)O)C(C(=O)O)N',
    'G': 'C(C(=O)O)N',
    'H': 'C1=C(NC=N1)C[C@@H](C(=O)O)N',
    'I': 'CC[C@H](C)[C@@H](C(=O)O)N',
    'L': 'CC(C)C[C@@H](C(=O)O)N',
    'K': 'C(CCN)CC(C(=O)O)N',
    'M': 'CSCCC(C(=O)O)N',
    'F': 'c1ccc(cc1)C[C@@H](C(=O)O)N',
    'P': 'C1CC(NC1)C(=O)O',
    'S': 'C([C@@H](C(=O)O)N)O',
    'T': 'C[C@H]([C@@H](C(=O)O)N)O',
    'W': 'c1ccc2c(c1)c(c[nH]2)C[C@@H](C(=O)O)N',
    'Y': 'N[C@@H](Cc1ccc(O)cc1)C(O)=O',
    'V': 'CC(C)[C@@H](C(=O)O)N'}

AminoAcidFreq = {
	'-': 0.050,
    'A': 0.074,
    'R': 0.042,
    'N': 0.044,
    'D': 0.059,
    'C': 0.033,
    'Q': 0.058,
    'E': 0.037,
    'G': 0.074,
    'H': 0.029,
    'I': 0.038,
    'L': 0.076,
    'K': 0.072,
    'M': 0.018,
    'F': 0.040,
    'P': 0.050,
    'S': 0.081,
    'T': 0.062,
    'W': 0.013,
    'Y': 0.033,
    'V': 0.068,
    'X': 0.050
    }

# from https://www.ncbi.nlm.nih.gov/Class/FieldGuide/BLOSUM62.txt
BLOSUM62 = np.array([
    [ 4, -1, -2, -2,  0, -1, -1,  0, -2, -1, -1, -1, -1, -2, -1,  1,  0, -3, -2,  0,  0, -4], # A 
    [-1,  5,  0, -2, -3,  1,  0, -2,  0, -3, -2,  2, -1, -3, -2, -1, -1, -3, -2, -3, -1, -4], # R 
    [-2,  0,  6,  1, -3,  0,  0,  0,  1, -3, -3,  0, -2, -3, -2,  1,  0, -4, -2, -3, -1, -4], # N 
    [-2, -2,  1,  6, -3,  0,  2, -1, -1, -3, -4, -1, -3, -3, -1,  0, -1, -4, -3, -3, -1, -4], # D 
    [ 0, -3, -3, -3,  9, -3, -4, -3, -3, -1, -1, -3, -1, -2, -3, -1, -1, -2, -2, -1, -2, -4], # C 
    [-1,  1,  0,  0, -3,  5,  2, -2,  0, -3, -2,  1,  0, -3, -1,  0, -1, -2, -1, -2, -1, -4], # Q 
    [-1,  0,  0,  2, -4,  2,  5, -2,  0, -3, -3,  1, -2, -3, -1,  0, -1, -3, -2, -2, -1, -4], # E 
    [ 0, -2,  0, -1, -3, -2, -2,  6, -2, -4, -4, -2, -3, -3, -2,  0, -2, -2, -3, -3, -1, -4], # G 
    [-2,  0,  1, -1, -3,  0,  0, -2,  8, -3, -3, -1, -2, -1, -2, -1, -2, -2,  2, -3, -1, -4], # H 
    [-1, -3, -3, -3, -1, -3, -3, -4, -3,  4,  2, -3,  1,  0, -3, -2, -1, -3, -1,  3, -1, -4], # I 
    [-1, -2, -3, -4, -1, -2, -3, -4, -3,  2,  4, -2,  2,  0, -3, -2, -1, -2, -1,  1, -1, -4], # L 
    [-1,  2,  0, -1, -3,  1,  1, -2, -1, -3, -2,  5, -1, -3, -1,  0, -1, -3, -2, -2, -1, -4], # K 
    [-1, -1, -2, -3, -1,  0, -2, -3, -2,  1,  2, -1,  5,  0, -2, -1, -1, -1, -1,  1, -1, -4], # M 
    [-2, -3, -3, -3, -2, -3, -3, -3, -1,  0,  0, -3,  0,  6, -4, -2, -2,  1,  3, -1, -1, -4], # F 
    [-1, -2, -2, -1, -3, -1, -1, -2, -2, -3, -3, -1, -2, -4,  7, -1, -1, -4, -3, -2, -2, -4], # P 
    [ 1, -1,  1,  0, -1,  0,  0,  0, -1, -2, -2,  0, -1, -2, -1,  4,  1, -3, -2, -2,  0, -4], # S 
    [ 0, -1,  0, -1, -1, -1, -1, -2, -2, -1, -1, -1, -1, -2, -1,  1,  5, -2, -2,  0,  0, -4], # T 
    [-3, -3, -4, -4, -2, -2, -3, -2, -2, -3, -2, -3, -1,  1, -4, -3, -2, 11,  2, -3, -2, -4], # W 
    [-2, -2, -2, -3, -2, -1, -2, -3,  2, -1, -1, -2, -1,  3, -3, -2, -2,  2,  7, -1, -1, -4], # Y 
    [ 0, -3, -3, -3, -1, -2, -2, -3, -3,  3,  1, -2,  1, -1, -2, -2,  0, -3, -1,  4, -1, -4], # V 
    [ 0, -1, -1, -1, -2, -1, -1, -1, -1, -1, -1, -1, -1, -1, -2,  0,  0, -2, -1, -1, -1, -4], # X 
    [-4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4,  1]]) # * 

# from https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2144252/pdf/10048329.pdf B matrix
ContactPotential = np.array([
    [-0.20,  0.27,  0.24,  0.30, -0.26,  0.21,  0.43, -0.03,  0.21, -0.35, -0.37,  0.20, -0.23, -0.33,  0.07,  0.15,  0.00, -0.40, -0.15, -0.38, -0.02, -0.02], # A
    [ 0.27,  0.13,  0.02, -0.71,  0.32, -0.12, -0.75,  0.14,  0.04,  0.18,  0.09,  0.50,  0.17,  0.08, -0.02,  0.12,  0.00, -0.41, -0.37,  0.17, -0.03, -0.03], # R
    [ 0.24,  0.02, -0.04, -0.12,  0.28, -0.05, -0.01,  0.10,  0.10,  0.55,  0.36, -0.14,  0.32,  0.29,  0.13,  0.14,  0.00, -0.09,  0.01,  0.39,  0.12,  0.12], # N
    [ 0.30, -0.71, -0.12,  0.27,  0.38,  0.12,  0.40,  0.17, -0.22,  0.54,  0.62, -0.69,  0.62,  0.48,  0.25,  0.01,  0.00,  0.06, -0.07,  0.66,  0.15,  0.15], # D
    [-0.26,  0.32,  0.28,  0.38, -1.34,  0.04,  0.46, -0.09, -0.19, -0.48, -0.50,  0.35, -0.49, -0.53, -0.18,  0.09,  0.00, -0.74, -0.16, -0.51, -0.12, -0.12], # C
    [ 0.21, -0.12, -0.05,  0.12,  0.04,  0.14,  0.10,  0.20,  0.22,  0.14,  0.08, -0.20, -0.01, -0.04, -0.05,  0.25,  0.00, -0.11, -0.18,  0.17,  0.07,  0.07], # Q
    [ 0.43, -0.75, -0.01,  0.40,  0.46,  0.10,  0.45,  0.48, -0.11,  0.38,  0.37, -0.87,  0.24,  0.34,  0.26,  0.10,  0.00, -0.15, -0.16,  0.41,  0.13,  0.13], # E
    [-0.03,  0.14,  0.10,  0.17, -0.09,  0.20,  0.48, -0.20,  0.23,  0.21,  0.14,  0.12,  0.08,  0.11, -0.01,  0.10,  0.00, -0.24, -0.04,  0.04,  0.08,  0.08], # G
    [ 0.21,  0.04,  0.10, -0.22, -0.19,  0.22, -0.11,  0.23, -0.33,  0.19,  0.10,  0.26, -0.17, -0.19, -0.05,  0.15,  0.00, -0.46, -0.21,  0.18,  0.05,  0.05], # H
    [-0.35,  0.18,  0.55,  0.54, -0.48,  0.14,  0.38,  0.21,  0.19, -0.60, -0.79,  0.21, -0.60, -0.65,  0.05,  0.35,  0.00, -0.65, -0.33, -0.68, -0.07, -0.07], # I
    [-0.37,  0.09,  0.36,  0.62, -0.50,  0.08,  0.37,  0.14,  0.10, -0.79, -0.81,  0.16, -0.68, -0.78, -0.08,  0.26,  0.00, -0.70, -0.44, -0.80, -0.14, -0.14], # L
    [ 0.20,  0.50, -0.14, -0.69,  0.35, -0.20, -0.87,  0.12,  0.26,  0.21,  0.16,  0.38,  0.22,  0.11,  0.12,  0.10,  0.00, -0.28, -0.40,  0.16,  0.04,  0.04], # K
    [-0.23,  0.17,  0.32,  0.62, -0.49, -0.01,  0.24,  0.08, -0.17, -0.60, -0.68,  0.22, -0.56, -0.89, -0.16,  0.32,  0.00, -0.94, -0.51, -0.47, -0.11, -0.11], # M
    [-0.33,  0.08,  0.29,  0.48, -0.53, -0.04,  0.34,  0.11, -0.19, -0.65, -0.78,  0.11, -0.89, -0.82, -0.19,  0.10,  0.00, -0.78, -0.49, -0.67, -0.18, -0.18], # F
    [ 0.07, -0.02,  0.13,  0.25, -0.18, -0.05,  0.26, -0.01, -0.05,  0.05, -0.08,  0.12, -0.16, -0.19, -0.07,  0.17,  0.00, -0.73, -0.40, -0.08, -0.00, -0.00], # P
    [ 0.15,  0.12,  0.14,  0.01,  0.09,  0.25,  0.10,  0.10,  0.15,  0.35,  0.26,  0.10,  0.32,  0.10,  0.17,  0.13,  0.00,  0.07,  0.07,  0.25,  0.14,  0.14], # S
    [ 0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00,  0.00], # T
    [-0.40, -0.41, -0.09,  0.06, -0.74, -0.11, -0.15, -0.24, -0.46, -0.65, -0.70, -0.28, -0.94, -0.78, -0.73,  0.07,  0.00, -0.74, -0.55, -0.62, -0.36, -0.36], # W
    [-0.15, -0.37,  0.01, -0.07, -0.16, -0.18, -0.16, -0.04, -0.21, -0.33, -0.44, -0.40, -0.51, -0.49, -0.40,  0.07,  0.00, -0.55, -0.27, -0.27, -0.21, -0.21], # Y
    [-0.38,  0.17,  0.39,  0.66, -0.51,  0.17,  0.41,  0.04,  0.18, -0.68, -0.80,  0.16, -0.47, -0.67, -0.08,  0.25,  0.00, -0.62, -0.27, -0.72, -0.11, -0.11], # V
    [-0.02,  0.03,  0.12,  0.15, -0.12,  0.07,  0.13,  0.08,  0.05, -0.07, -0.14,  0.04, -0.11, -0.18, -0.00,  0.14,  0.00, -0.36, -0.21, -0.11,  0.00,  0.00], # X, calculated as weighted (freq) sum
    [-0.02,  0.03,  0.12,  0.15, -0.12,  0.07,  0.13,  0.08,  0.05, -0.07, -0.14,  0.04, -0.11, -0.18, -0.00,  0.14,  0.00, -0.36, -0.21, -0.11,  0.00,  0.00]]) # -, same as X
